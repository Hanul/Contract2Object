global.SmartContract=CLASS(n=>{let t,e=require("web3"),i=!1;void 0!==e.givenProvider&&(t=new e(e.givenProvider),i=!0);let u=n.checkWeb3Enable=(()=>{return i}),o=(n,t)=>{if(0!==n.length){if(1===n.length){let e=n[0].type;if("[]"===e.substring(e.length-2)){let n=[],i=[];return EACH(t,(t,u)=>{e.indexOf("int")!==-1?(n.push(INTEGER(t)),i.push(t)):(n.push(t),i.push(t))}),{value:n,str:i}}return e.indexOf("int")!==-1?{value:INTEGER(t),str:t}:{value:t,str:t}}if(n.length>1){let e=[];return EACH(n,(n,i)=>{let u=n.type;if("[]"===u.substring(u.length-2)){let n=[];EACH(t[i],(t,e)=>{u.indexOf("int")!==-1?n.push(INTEGER(t)):n.push(t)}),e.push(n)}else u.indexOf("int")!==-1?e.push(INTEGER(t[i])):e.push(t[i])}),EACH(n,(n,i)=>{let u=n.type;if("[]"===u.substring(u.length-2)){let n=[];EACH(t[i],(t,e)=>{u.indexOf("int")!==-1?n.push(t):n.push(t)}),e.push(n)}else u.indexOf("int")!==-1?e.push(t[i]):e.push(t[i])}),{array:e}}}};return{init:(n,s,r)=>{if(void 0===t&&void 0!==NODE_CONFIG.infuraProjectId){let n=()=>{let i=new e.providers.WebsocketProvider("wss://"+(void 0===NODE_CONFIG.infuraServerName?"mainnet":NODE_CONFIG.infuraServerName)+".infura.io/ws/v3/"+NODE_CONFIG.infuraProjectId);return i.on("end",e=>{SHOW_ERROR("SmartContract","WebsocketProvider의 접속이 끊어졌습니다. 재접속합니다."),t.setProvider(n())}),i};t=new e(n()),i=!0}let a,f=r.abi,E=r.address,p=(s.getAddress=(()=>{return E}),{});u()===!0&&(a=new t.eth.Contract(f,E),a.events.allEvents((n,t)=>{if(n===TO_DELETE){let n=p[t.event];void 0!==n&&EACH(n,n=>{n(t.returnValues)})}}),EACH(f,n=>{"function"===n.type&&(s[n.name]=((t,e)=>{void 0===e&&(e=t,t=void 0);let i,u,s;CHECK_IS_DATA(e)!==!0?i=e:(i=e.success,u=e.transactionAddress,s=e.error);let r=[];if(n.payable!==!0&&n.inputs.length<=1)0!==n.inputs.length&&r.push(t);else{let e=[];EACH(t,n=>{e.push(n)}),EACH(n.inputs,(n,i)=>{""!==n.name?r.push(t[n.name]):r.push(e[i])})}a.methods[n.name].apply(a.methods,r).call((e,u)=>{e!==TO_DELETE?void 0!==s?s(e.toString()):SHOW_ERROR(n.name,e.toString(),t):n.constant===!0&&void 0!==i&&(0===n.outputs.length?i():1===n.outputs.length?(u=o(n.outputs,u),i(u.value,u.str)):n.outputs.length>1&&(u=o(n.outputs,u),i.apply(TO_DELETE,u.array)))})}))}));s.on=((n,t)=>{void 0===p[n]&&(p[n]=[]),p[n].push(t)}),s.off=((n,t)=>{void 0!==p[n]&&(void 0!==t&&REMOVE({array:p[n],value:t}),void 0!==t&&0!==p[n].length||delete p[n])});void 0!==global.UPPERCASE&&void 0!==UPPERCASE.ROOM&&UPPERCASE.ROOM("__SmartContract/"+E,(n,t,e)=>{EACH(f,n=>{"function"===n.type&&t(n.name,(t,e)=>{let i=[];if(n.payable!==!0&&n.inputs.length<=1)0!==n.inputs.length&&i.push(t);else{let e=[];EACH(t,n=>{e.push(n)}),EACH(n.inputs,(n,u)=>{""!==n.name?i.push(t[n.name]):i.push(e[u])})}a.methods[n.name].apply(a.methods,i).call((i,u)=>{i!==TO_DELETE?SHOW_ERROR(n.name,i.toString(),t):n.constant===!0&&e(o(n.outputs,u))})})})})}}});